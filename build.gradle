apply plugin: 'groovy'
apply plugin: 'maven'

project.version = '1.9.6'
project.group = 'org.jastadd'

// Ensure the plugin runs with Java 7.
sourceCompatibility = '1.7'
targetCompatibility = '1.7'

dependencies {
	compile gradleApi()
	compile localGroovy()
}

configurations {
	deployerJars
}

repositories {
	mavenCentral()
}

dependencies {
	deployerJars "org.apache.maven.wagon:wagon-ssh:2.4"
}

uploadArchives {
	repositories.mavenDeployer {
		configuration = configurations.deployerJars
		def sshServer = 'scp://web.cs.lth.se/Websites/jastadd/mvn/'
		repository(url: sshServer) {
			if (project.hasProperty('sshUser')) {
				authentication(userName: project.sshUser)
				println "Connecting to ${sshServer} using user=${project.sshUser}."
				println "If this times out you may need to manually ssh to the server first."
			} else {
				println "Warning: ssh username not set. Artifact upload may fail."
				println "To set the ssh username, run gradle with -PsshUser=username."
			}
		}
	}
}

